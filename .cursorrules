# Vivara Products App - Cursor AI Rules

## Project Context

- Framework: Vue 3 Composition API + TypeScript
- Build: Vite
- UI: PrimeVue + Tailwind CSS
- State: Pinia
- Testing: Vitest (unit) + Playwright (E2E)
- API: DummyJSON (does NOT persist writes)

## File Organization

- **Unit tests**: Co-locate with source (ProductList.spec.ts next to ProductList.vue)
- **E2E tests**: Keep in tests/e2e/ (full user flows)
- **Components**: Group by feature (products/, common/)
- **Types**: Define in src/types/
- **Services**: API calls in src/services/
- **Stores**: Pinia stores in src/stores/
- **Composables**: Reusable logic in src/composables/

## Code Style Rules

### Vue 3 Components

- ALWAYS use `<script setup lang="ts">`
- Use Composition API (ref, computed, watch)
- Structure: script → template → style
- Extract complex logic into composables
- Keep components under 200 lines

### Testing

- Unit tests: \*.spec.ts next to source file
- Test composables, services, stores
- Test component behavior (not markup)
- Use data-testid for E2E selectors
- Aim for 80%+ coverage on critical paths

### TypeScript

- Use strict mode
- Define interfaces in src/types/
- Avoid any (use unknown if needed)
- Type all function parameters and returns

### Naming

- Components: PascalCase (ProductList.vue)
- Composables: camelCase with "use" prefix (useProducts.ts)
- Types: PascalCase (Product, ApiResponse)
- Test files: \*.spec.ts

### API & State

- All API calls through src/services/api.ts
- Use Pinia for global state (products, categories)
- Simulate CRUD locally (DummyJSON doesn't persist)
- Optimistic updates with rollback on error
- **BFF Pattern**: Consider Backend for Frontend pattern for production (see ARCHITECTURE.md)

### Styling Architecture

#### Three-Layer Approach

1. **Tailwind CSS** (style.css - PostCSS)

   - Use for: Layout (flex, grid), spacing (p-_, m-_), responsive (md:, lg:)
   - Global utilities, applied via class attributes
   - DO NOT put @tailwind in .scss files

2. **SCSS** (\*.vue <style lang="scss">)

   - Use for: Variables, mixins, nesting, complex animations
   - Custom component styles that need SCSS features
   - Variables auto-imported via vite.config.ts

3. **PrimeVue** (Components - Runtime)
   - Use for: Complex UI components (DataTable, Dialog, Calendar)
   - Pre-styled, interactive components
   - Combine with Tailwind classes for width/spacing

#### Rules

✅ Tailwind classes in template: `<div class="flex gap-4">`
✅ SCSS in style block: `<style scoped lang="scss">$var: value;</style>`
✅ PrimeVue components: `<DataTable class="w-full" />`

❌ Don't put @tailwind in .scss files (PostCSS directive, not SCSS)
❌ Don't duplicate Tailwind utilities in SCSS
❌ Don't override PrimeVue internal styles (use severity/props instead)

#### File Structure

- `src/style.css` - Tailwind imports (PostCSS)
- `src/styles/_variables.scss` - SCSS variables (auto-imported)
- `*.vue` files - Use `<style scoped lang="scss">` for custom styles

### Accessibility

- Semantic HTML
- aria-labels on icon buttons
- Keyboard navigation support
- WCAG AA contrast ratios

## When Generating Code

1. Define TypeScript interfaces first
2. Create service functions for API
3. Build composable for logic
4. Create component using composable
5. Add co-located test file
6. Document trade-offs if needed

## Forbidden

- ❌ Options API (use Composition only)
- ❌ Inline styles (use Tailwind)
- ❌ console.log in production
- ❌ Hardcoded URLs (use env vars)
- ❌ any type without justification
- ❌ Untested critical paths
